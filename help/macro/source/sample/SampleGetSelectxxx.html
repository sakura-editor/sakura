<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<title>S_GetSelectxxxの使用例</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
</head>
<body>
<small>
Sakura-Editor Macro Reference
</small>
<h2>S_GetSelectxxxの使用例</h2>

<pre>
<span class="green">//sample.js
//カーソル位置の単語のバイト数</span>
<span class="blue">SelectWord</span>;
<span class="blue">var</span> iLen = <span class="blue">GetSelectColmTo</span> - <span class="blue">GetSelectColmFrom</span>;

<span class="blue">var</span> oWsh = <span class="blue">new</span> ActiveXObject(<span class="maroon">"WScript.Shell"</span>);
oWsh.Popup(iLen + "byte", <span class="red">0</span>, <span class="maroon">""</span>, <span class="red">0</span>);
</pre>

<pre>
<span class="green">//sample.ppa
//選択状態を調べる</span>
<span class="blue">if S_IsTextSelected</span> = <span class="red">0</span> <span class="blue">then</span>
  <span class="blue">MessageBox</span>(<span class="maroon">'非選択状態です'</span>, <span class="maroon">'title'</span>, <span class="red">0</span>)

<span class="blue">else if S_IsTextSelected</span> &gt; <span class="red">1</span> <span class="blue">then</span>
  <span class="blue">MessageBox</span>(<span class="maroon">'矩形選択状態です'</span>, <span class="maroon">'title'</span>, <span class="red">0</span>)

<span class="blue">else if</span> (<span class="blue">S_GetSelectColmFrom</span> = <span class="red">1</span>) and (<span class="blue">S_GetSelectColmTo</span> = <span class="red">1</span>) <span class="blue">then</span>
  <span class="blue">MessageBox</span>(<span class="maroon">'行選択状態です'</span>, <span class="maroon">'title'</span>, <span class="red">0</span>)

<span class="blue">else if S_GetSelectLineFrom</span> = <span class="blue">S_GetSelectLineTo</span> <span class="blue">then</span>
  <span class="blue">MessageBox</span>(<span class="maroon">'１行以内の部分選択です'</span>, <span class="maroon">'title'</span>, <span class="red">0</span>)

<span class="blue">else</span>
  <span class="blue">MessageBox</span>(<span class="maroon">'複数行にまたがった部分選択です'</span>, <span class="maroon">'title'</span>, <span class="red">0</span>)
;
</pre>

<hr>
</body></html>
