<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<title>S_SearchNextの使用例</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
</head>
<body>
<small>
Sakura-Editor Macro Reference
</small>
<h2>S_SearchNextの使用例</h2>

<pre>
<span class="green">&#39; sample.vbs</span>
<span class="green">&#39; 文字列"function"の数をカウントする</span>
<span class="blue">Dim</span> sKey, lngCnt
sKey = <span class="maroon">"function"</span>

<span class="blue">GoFileTop</span>
lngLine = <span class="blue">ExpandParameter</span>(CStr(<span class="maroon">"$y"</span>))
<span class="blue">SearchNext</span> <span class="blue">CStr</span>(sKey), <span class="blue">CLng</span>(<span class="red">16</span>)

<span class="blue">Do</span> <span class="blue">Until</span> (<span class="blue">ExpandParameter</span>(<span class="blue">CStr</span>(<span class="maroon">"$y"</span>)) = lngLine)
    lngCnt = lngCnt + <span class="red">1</span>
    lngLine = <span class="blue">ExpandParameter</span>(<span class="blue">CStr</span>(<span class="maroon">"$y"</span>))
    <span class="blue">SearchNext</span> <span class="blue">CStr</span>(sKey), <span class="blue">CLng</span>(<span class="red">16</span>)
<span class="blue">Loop</span>

<span class="blue">MsgBox</span> <span class="maroon">"文字列 """</span> & sKey & <span class="maroon">"""は、"</span> & lngCnt & <span class="maroon">"個みつかりました"</span>
</pre>

<hr>
</body></html>
