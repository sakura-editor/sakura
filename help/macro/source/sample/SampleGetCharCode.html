<html><head><title>S_GetCharCodeの使用例</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=Shift_JIS">
</head>
<body>
<small>
Sakura-Editor Macro Reference
</small>
<h2>S_GetCharCodeの使用例</h2>

<pre>
<span style = "color:green;">//sample.js
//どの文字コードでファイルを開いているか</span>
<span style = "color:blue;">var</span> oWsh = <span style = "color:blue;">new</span> ActiveXObject(<span style = "color:#800000">"WScript.Shell"</span>);
<span style = "color:blue;">switch</span> (<span style = "color:blue;">GetCharCode</span>) {
<span style = "color:blue;">case</span> <span style = "color:red;">0</span>:
    oWsh.Popup(<span style = "color:#800000;">"SJISで開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">case</span> <span style = "color:red;">1</span>:
    oWsh.Popup(<span style = "color:#800000;">"JISで開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">case</span> <span style = "color:red;">2</span>:
    oWsh.Popup(<span style = "color:#800000;">"EUCで開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">case</span> <span style = "color:red;">3</span>:
    oWsh.Popup(<span style = "color:#800000;">"Unicodeで開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">case</span> <span style = "color:red;">4</span>:
    oWsh.Popup(<span style = "color:#800000;">"UTF-8で開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">case</span> <span style = "color:red;">5</span>:
    oWsh.Popup(<span style = "color:#800000;">"UTF-7で開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">case</span> <span style = "color:red;">6</span>:
    oWsh.Popup(<span style = "color:#800000;">"UnicodeBEで開いています"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
<span style = "color:blue;">default</span>:
    oWsh.Popup(<span style = "color:#800000;">"不明"</span>, <span style = "color:red;">0</span>, <span style = "color:#800000;">"現在の文字コード"</span>, <span style = "color:red;">0</span>);
    <span style = "color:blue;">break</span>;
}
</pre>

<pre>
<span style = "color:green;">//sample.ppa
//どの文字コードでファイルを開いているか</span>
<span style = "color:blue;">case S_GetCharCode of</span>
<span style = "color:red;">0</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'SJISで開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:red;">1</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'JISで開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:red;">2</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'EUCで開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:red;">3</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'Unicodeで開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:red;">4</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'UTF-8で開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:red;">5</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'UTF-7で開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:red;">6</span>:
    <span style = "color:blue;">MessageBox</span>(<span style = "color:#800000;">'UnicodeBEで開いています'</span>, <span style = "color:#800000;">'現在の文字コード'</span>, <span style = "color:red;">0</span>);
<span style = "color:blue;">end</span>
</pre>

<hr>
</body></html>
