<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<title>S_GetCharCodeの使用例</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
</head>
<body>
<small>
Sakura-Editor Macro Reference
</small>
<h2>S_GetCharCodeの使用例</h2>

<pre>
<span class="green">//sample.js
//どの文字コードでファイルを開いているか</span>
<span class="blue">var</span> oWsh = <span class="blue">new</span> ActiveXObject(<span class="maroon">"WScript.Shell"</span>);
<span class="blue">switch</span> (<span class="blue">GetCharCode</span>) {
<span class="blue">case</span> <span class="red">0</span>:
    oWsh.Popup(<span class="maroon">"SJISで開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">case</span> <span class="red">1</span>:
    oWsh.Popup(<span class="maroon">"JISで開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">case</span> <span class="red">2</span>:
    oWsh.Popup(<span class="maroon">"EUCで開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">case</span> <span class="red">3</span>:
    oWsh.Popup(<span class="maroon">"Unicodeで開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">case</span> <span class="red">4</span>:
    oWsh.Popup(<span class="maroon">"UTF-8で開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">case</span> <span class="red">5</span>:
    oWsh.Popup(<span class="maroon">"UTF-7で開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">case</span> <span class="red">6</span>:
    oWsh.Popup(<span class="maroon">"UnicodeBEで開いています"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
<span class="blue">default</span>:
    oWsh.Popup(<span class="maroon">"不明"</span>, <span class="red">0</span>, <span class="maroon">"現在の文字コード"</span>, <span class="red">0</span>);
    <span class="blue">break</span>;
}
</pre>

<pre>
<span class="green">//sample.ppa
//どの文字コードでファイルを開いているか</span>
<span class="blue">case S_GetCharCode of</span>
<span class="red">0</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'SJISで開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="red">1</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'JISで開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="red">2</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'EUCで開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="red">3</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'Unicodeで開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="red">4</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'UTF-8で開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="red">5</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'UTF-7で開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="red">6</span>:
    <span class="blue">MessageBox</span>(<span class="maroon">'UnicodeBEで開いています'</span>, <span class="maroon">'現在の文字コード'</span>, <span class="red">0</span>);
<span class="blue">end</span>
</pre>

<hr>
</body></html>
