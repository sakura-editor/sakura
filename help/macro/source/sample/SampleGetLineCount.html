<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<title>S_GetLineCountの使用例</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
</head>
<body>
<small>
Sakura-Editor Macro Reference
</small>
<h2>S_GetLineCountの使用例</h2>

<pre>
<span class="green">//sample.js</span>
<span class="green">//空行をカウントする</span>
<span class="blue">var</span> iLine = <span class="red">0</span>;
<span class="blue">var</span> iCount = <span class="red">0</span>;
<span class="blue">var</span> iMax = <span class="blue">GetLineCount</span>(<span class="red">0</span>);	<span class="green">//論理行数を取得</span>
<span class="blue">while</span> (++iLine &lt;= iMax){	<span class="green">//全行をループ</span>
    <span class="blue">if</span> (<span class="blue">GetLineStr</span>(iLine).<span class="blue">match</span>(/[^\t ]+/) == <span class="red">0</span>){
        iCount++;
    }
}

<span class="blue">var</span> oWsh = <span class="blue">new</span> ActiveXObject(<span class="maroon">"WScript.Shell"</span>);
oWsh.Popup(iCount, <span class="red">0</span>, <span class="maroon">""</span>, <span class="red">0</span>);
</pre>

<pre>
<span class="green">//sample.ppa
//最大桁数を調べる</span>
<span class="blue">var</span>
    iCount : <span class="blue">integer</span>;
    iLen : <span class="blue">integer</span>;
    iMax : <span class="blue">integer</span>;

<span class="blue">begin</span>
    iCount := <span class="blue">S_GetLineCount</span>(<span class="red">0</span>);   <span class="green">//行数取得</span>

    <span class="blue">while</span> iCount <span class="blue">do</span>
    <span class="blue">begin</span>                    <span class="green">//全行ループ</span>
        iLen := <span class="blue">Length</span>( <span class="blue">S_GetLineStr</span>(iCount) );
        <span class="blue">if</span> iMax &lt; iLen <span class="blue">then</span> iMax := iLen;
        iCount := iCount - <span class="red">1</span>;
    <span class="blue">end</span>;
    <span class="blue">MessageBox</span>(<span class="blue">IntToStr</span>(iMax), <span class="maroon">'最大桁数'</span>, <span class="red">0</span>);
<span class="blue">end</span>;
</pre>

<hr>
</body></html>
