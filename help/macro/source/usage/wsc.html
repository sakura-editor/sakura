<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<title>Windows Script Componentの使用</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
</head>
<small>
Sakura-Editor Macro Reference
</small>
<h2>Windows Script Componentの使用</h2>
<p>WSHマクロにおいてWindows Script Component(*.wsc)を使用することで
各種スクリプトを混在で利用できます。
</p>
<p>wscファイル内では、Editorオブジェクトが見えないので、
呼び出し元からEditorオブジェクトを渡す必要があります。
</p>

<h3>WSCサンプル（呼ばれる側）</h3>
<pre>
&lt;?xml version=<span class="maroon">"1.0"</span>?&gt;
&lt;component&gt;
&lt;public&gt;
        &lt;method name=<span class="maroon">"InsTextVBS"</span>&gt;
                &lt;PARAMETER name=<span class="maroon">"Editor"</span>/&gt;
                &lt;PARAMETER name=<span class="maroon">"sBuf"</span>/&gt;
        &lt;/method&gt;
        &lt;method name=<span class="maroon">"InsTextJS"</span>&gt;
                &lt;PARAMETER name=<span class="maroon">"Editor"</span>/&gt;
                &lt;PARAMETER name=<span class="maroon">"sBuf"</span>/&gt;
        &lt;/method&gt;
&lt;/public&gt;
&lt;script language=<span class="maroon">"VBScript"</span>&gt;
&lt;![CDATA[
<span class="blue">Sub</span> InsTextVBS(Editor, sBuf)
    <span class="green">&#39;VBSエンジンによる処理</span>
    Editor.InsText(Cstr(sBuf))
End <span class="blue">Sub</span>
]]&gt;
&lt;/script&gt;
&lt;script language=<span class="maroon">"JScript"</span>&gt;
&lt;![CDATA[
<span class="blue">function</span> InsTextJS(Editor, sBuf)
{
    <span class="green">//JSエンジンによる処理</span>
    Editor.InsText(sBuf + '');
}
]]&gt;
&lt;/script&gt;
&lt;/component&gt;
</pre>

<h3>VBScriptから呼び出し</h3>
<pre>
WSC_PATH = <span class="maroon">"L:\func.wsc"</span>
<span class="blue">Set</span> oFunc=GetObject(<span class="maroon">"Script:"</span> & WSC_PATH)
<span class="blue">Call</span> oFunc.InsTextJS(Editor, <span class="maroon">"By JScript"</span>)
<span class="blue">Set</span> oFunc = <span class="blue">Nothing</span>
</pre>

<h3>JScriptから呼び出し</h3>
<pre>
<span class="blue">var</span> WSC_PATH = <span class="maroon">"L:\\func.wsc"</span>;
<span class="blue">var</span> oFunc = GetObject(<span class="maroon">"Script:"</span> + WSC_PATH);
oFunc.InsTextVBS(Editor, <span class="maroon">"By VBScript"</span>);
</pre>


<hr>
</body></html>

