<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<title>ScriptControlの使用</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="../sakura.css">
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
</head>
<small>
Sakura-Editor Macro Reference
</small>
<h2>ScriptControlの使用</h2>
<p>WSHマクロにおいてScriptControlを使用することで
各種スクリプトを混在で利用できます。
</p>
<a href="http://www.microsoft.com/Japan/msdn/Scripting/navigation.htm?/japan/msdn/scripting/scriptcontrol/scoverview.htm" target="_blank" rel="noopener">Script Control - Microsoft Scripting Technologies</a>

<h3>JScriptサンプル</h3>
<pre>
<span class="green">//JScriptからVBSのInputBox関数を実行</span>
<span class="blue">var</span> oSC = <span class="blue">new</span> ActiveXObject(<span class="maroon">"ScriptControl"</span>);
oSC.Language = <span class="maroon">"VBScript"</span>;
<span class="blue">var</span> sFunc = <span class="maroon">'Function InBox(prompt, title, default)\n'</span>;
sFunc += <span class="maroon">'    InBox = InputBox(prompt, title, default)\n'</span>;
sFunc += <span class="maroon">'End Function\n'</span>;
oSC.AddCode(sFunc);
<span class="blue">var</span> Ret = oSC.Run (<span class="maroon">"InBox"</span>, <span class="maroon">"メッセージ"</span>, <span class="maroon">"タイトル"</span>, <span class="maroon">"初期値"</span>);
<span class="blue">InsText</span>(Ret);
</pre>


<h3>VBScriptサンプル</h3>
<pre>
<span class="green">&#39;VBScriptからJscriptのsplit関数を実行</span>
<span class="blue">Dim</span> sCode, oSC, sFileName

sCode = <span class="maroon">"GetFileNameFromFulPath=function(sBuf) {aRet=sBuf.split('\\');return aRet[aRet.length-1];}"</span>

<span class="blue">Set</span> oSC = CreateObject(<span class="maroon">"ScriptControl"</span>)
oSC.Language = <span class="maroon">"JScript"</span>
oSC.AddCode(sCode)
sFileName = oSC.Run(<span class="maroon">"GetFileNameFromFulPath"</span>, <span class="maroon">"c:\winnt\notepad.exe"</span>)
<span class="blue">Set</span> oSC = <span class="blue">Nothing</span>

<span class="blue">InsText</span>(sFileName)
</pre>

<h3>PerlScriptサンプル</h3>
<pre>
<span class="green"># http://miau.s9.xrea.com/blog/index.php?itemid=397</span>
<span class="blue">sub</span> InputBox
{
    <span class="blue">my</span> @args = @_;
    @args = map { encode('cp932', $_) } @args;
    <span class="blue">while</span> (@args &lt; 3) {
        <span class="blue">push</span> @args, '';
    }
    
    <span class="blue">my</span> $sc = Win32::OLE-&gt;CreateObject(<span class="maroon">"ScriptControl"</span>);
    $sc-&gt;{Language} = <span class="maroon">"VBScript"</span>;
    $sc-&gt;AddCode(&lt;&lt;EOC);
Function Main(prompt, title, default)
    Main = InputBox(prompt, title, default)
End Function
EOC
    <span class="blue">my</span> $ret = $sc-&gt;Run(<span class="maroon">"Main"</span>, @args);
    $ret = decode('cp932', $ret);
    
    <span class="blue">return</span> $ret;
}
</pre>

<hr>
</body></html>

